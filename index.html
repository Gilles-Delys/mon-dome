<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GéoDôme Pro - Calculateur Icosaèdre Classe I</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>

<header>
    <nav id="main-nav">
        <button id="btn-parametres" onclick="showTab('parametres')" class="active">Paramètres</button>
        <button onclick="showTab('schema')">Schéma</button>
        <button onclick="showTab('details')">Détails</button>
        <button onclick="showTab('resultats')">Résultats</button>
        <button onclick="showTab('export')">Export</button>
    </nav>
</header>

<main id="app-container">
    <section id="parametres" class="tab-content active">
        <aside id="sidebar">
            <h3 class="section-title">Paramètres de Construction</h3>
            
            <div class="input-group">
                <label class="tooltip" title="C'est le paramètre le plus critique. Elle correspond au nombre de segments en lesquels chaque arête d'un triangle de base (provenant de l'icosaèdre) est divisée.&#10;• 1V : Un simple icosaèdre.&#10;• 2V, 3V, 4V... : Plus la fréquence est élevée, plus le dôme est proche d'une sphère.">
                    <strong>Fréquence V :</strong>
                </label>
                <select id="v-freq" onchange="updateAll()">
                    <option value="2">2V</option><option value="3">3V</option>
                    <option value="4" selected>4V</option><option value="5">5V</option>
                    <option value="6">6V</option><option value="7">7V</option><option value="8">8V</option>
                </select>
            </div>

            <div class="input-group">
                <label class="tooltip" title="La dimension souhaitée du dôme. Tous les calculs découlent de ce rayon. Formule : $L = r \times \text{Facteur}$">
                    <strong>Rayon de la sphère (m) :</strong>
                </label>
                <input type="number" id="radius" value="2" step="0.1" onchange="updateAll()">
            </div>

            <div class="input-group">
                <label class="tooltip" title="Un dôme n'est pas toujours une demi-sphère.&#10;• 1/2 (Hémisphère)&#10;• 3/8, 5/8 (Plus ou moins haut que le rayon)">
                    <strong>Fraction de Sphère :</strong>
                </label>
                <select id="fraction" onchange="updateAll()">
                    <option value="0.375">3/8</option>
                    <option value="0.5">1/2</option>
                    <option value="0.625" selected>5/8</option>
                </select>
            </div>

            <h3 class="section-title">Typologie du Dôme</h3>
            <div class="radio-group">
                <label class="tooltip" title="Système Star-Hub : Grande rigidité, nécessite des connecteurs à 5/6 branches.">
                    <input type="radio" name="type" value="starhub" checked onchange="updateAll()"> Avec Connecteurs
                </label>
                <label class="tooltip" title="Méthode Krushke : Montants coupés avec angles Miter et Bevel.">
                    <input type="radio" name="type" value="krushke" onchange="updateAll()"> Sans Connecteurs
                </label>
                <label class="tooltip" title="Dôme Hub-and-Strut : Format classique Buckminster Fuller.">
                    <input type="radio" name="type" value="fuller" onchange="updateAll()"> Hub-and-Strut
                </label>
            </div>

            <h3 class="section-title">Matériaux</h3>
            <div class="input-group">
                <label>Largeur, mm :</label>
                <input type="number" id="width-mm" value="120" onchange="updateAll()">
            </div>
            <div class="input-group">
                <label>Épaisseur, mm :</label>
                <input type="number" id="thickness-mm" value="40" onchange="updateAll()">
            </div>
        </aside>

        <div id="visualizer-container">
            <div id="threejs-canvas"></div>
        </div>
    </section>

    <section id="schema" class="tab-content">
        <div class="content-wrapper">
            <h2>Schéma des Triangles et Montants</h2>
            <div id="schema-grid" class="grid-layout"></div>
        </div>
    </section>

    <section id="details" class="tab-content">
        <div class="content-wrapper">
            <h2>Cotations et Détails Techniques</h2>
            <div id="details-table"></div>
        </div>
    </section>

    <section id="resultats" class="tab-content">
        <div class="content-wrapper">
            <h2>Résultats des Calculs</h2>
            <div id="results-display"></div>
        </div>
    </section>

    <section id="export" class="tab-content">
        <div class="content-wrapper">
            <h2>Centre d'Exportation</h2>
            <div class="export-actions">
                <button onclick="exportCSV()" class="btn-primary">Exporter CSV (LibreOffice compatible)</button>
                <button onclick="window.print()" class="btn-secondary">Imprimer le Plan de Montage</button>
            </div>
            <div id="assembly-plan"></div>
        </div>
    </section>
</main>

<script src="script.js"></script>
</body>
</html>